<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L1 å–®å­—ç‰¹è¨“ç­</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        /* Custom scrollbar for better mobile experience */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-indigo-200 min-h-screen">

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // --- Icons (Inline SVGs to avoid external dependencies) ---
    const BookOpen = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
    );
    const Gamepad2 = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="6" y1="11" x2="10" y2="11"/><line x1="8" y1="9" x2="8" y2="13"/><line x1="15" y1="12" x2="15.01" y2="12"/><line x1="18" y1="10" x2="18.01" y2="10"/><path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z"/></svg>
    );
    const Mic = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
    );
    const Volume2 = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>
    );
    const CheckCircle = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
    );
    const XCircle = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
    );
    const Trophy = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8 21h8"/><path d="M12 17v4"/><path d="M7 4h10"/><path d="M17 4v6a5 5 0 1 1-10 0V4"/><path d="M8 10a5 5 0 0 0 8 0"/><path d="M3 4h4v6a2 2 0 0 1-2 2h0a2 2 0 0 1-2-2V4"/><path d="M21 4h-4v6a2 2 0 0 1 2 2h0a2 2 0 0 1 2-2V4"/></svg>
    );
    const Clock = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    );
    const AlertCircle = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
    );
    const ArrowRight = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
    );
    const Brain = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/><path d="M17.599 6.5a3 3 0 0 0 .399-1.375"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .585-.396"/><path d="M19.938 10.5a4 4 0 0 1 .585.396"/><path d="M6 18a4 4 0 0 1-1.97-3.284"/><path d="M17.97 14.716A4 4 0 0 1 16 18"/></svg>
    );
    const List = ({size=24, className=""}) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
    );


    // --- Data ---
    const vocabData = [
      { id: 1, word: "debate", ipa: "[dÉª`bet]", pos: "vt. vi.", meaning: "è¾¯è«–", sentence: "At the school assembly, the student council debated the issue of adding a student-run cafÃ© on campus.", mnemonic: "De-bate (The bait) -> è¾¯è«–å°±åƒæ”¾é¤Œ(bait)é‡£é­šï¼Œçœ‹èª°ä¸Šé‰¤ã€‚" },
      { id: 2, word: "penalty", ipa: "[`pÉ›ná¸·tÉª]", pos: "n. [C]", meaning: "æ‡²ç½°ï¼›åˆ‘ç½°", sentence: "If the company fails to deliver the goods on time, it may receive a penalty under the contract.", mnemonic: "Pen-alty -> ç”¨ç­†(Pen)å¯«ä¸‹ç½°å–®(penalty)ã€‚" },
      { id: 3, word: "imprisonment", ipa: "[Éªm`prÉªzá¹‡mÉ™nt]", pos: "n. [U]", meaning: "ç›£ç¦", sentence: "The hacker was sentenced to eight yearsâ€™ imprisonment for stealing private data.", mnemonic: "Im-prison-ment -> In prison (åœ¨ç›£ç„è£¡) çš„ç‹€æ…‹å°±æ˜¯ç›£ç¦ã€‚" },
      { id: 4, word: "prison", ipa: "[`prÉªzá¹‡]", pos: "n. [U, C]", meaning: "ç›£ç„", sentence: "The man was sent to prison for ten years for armed robbery.", mnemonic: "Prison -> Person (äºº) è¢«é—œèµ·ä¾†çš„åœ°æ–¹ã€‚" },
      { id: 5, word: "claim", ipa: "[klem]", pos: "n. [C]", meaning: "èªªæ³•ï¼›å®£ç¨±", sentence: "The influencer was criticized for making false claims about the product she was promoting.", mnemonic: "C-laim -> ç‚ºäº†(C)çˆ­å–æ¬Šåˆ©å¤§è²å–Šå«(exclaim)ã€‚" },
      { id: 6, word: "insist", ipa: "[Éªn`sÉªst]", pos: "vt. vi.", meaning: "å …æŒ", sentence: "Despite the cold weather outside, Tinaâ€™s little brother insisted that she take him to the park.", mnemonic: "In-sist -> Sist (ç«™ç«‹) -> ç«™åœ¨è£¡é¢ä¸è‚¯èµ° -> å …æŒã€‚" },
      { id: 7, word: "property", ipa: "[`prÉ‘pÉštÉª]", pos: "n. [U, C]", meaning: "åœ°ç”¢ï¼›æˆ¿åœ°ç”¢", sentence: "The farmer put up signs and fences to remind hikers that the field was his private property.", mnemonic: "Proper-ty -> é€™æ˜¯å±¬æ–¼æˆ‘é©ç•¶(Proper)çš„æ¬Šåˆ©ç¯„åœ -> è²¡ç”¢/åœ°ç”¢ã€‚" },
      { id: 8, word: "companion", ipa: "[kÉ™m`pÃ¦njÉ™n]", pos: "n. [C]", meaning: "åŒä¼´ï¼›å¤¥ä¼´", sentence: "I wanted a peaceful trip, but my traveling companion snored louder than the noise of the airplane engine.", mnemonic: "Com-pan-ion -> ä¸€èµ·(Com)åˆ†éºµåŒ…(pan)åƒçš„äºº -> åŒä¼´ã€‚" },
      { id: 9, word: "mental", ipa: "[`mÉ›ntá¸·]", pos: "adj.", meaning: "å¿ƒç†çš„ï¼›ç²¾ç¥ä¸Šçš„", sentence: "The phrase â€œbe confidentâ€ gives me a mental image of myself trying to smile while panicking inside.", mnemonic: "Men-tal -> ç”·äºº(Men)å¿ƒè£¡çš„(mental)è‹¦èªªä¸å‡ºã€‚" },
      { id: 10, word: "devour", ipa: "[dÉª`vaÊŠr]", pos: "vt.", meaning: "ç†±åˆ‡åœ°è®€ï¼›ç‹¼åè™åš¥", sentence: "The detective devoured every word in the suspectâ€™s diary, hoping to find a clue.", mnemonic: "De-vour -> å¼Ÿ(De)å¼Ÿç™¼é¤“(vour - vor) -> ç‹¼åè™åš¥ã€‚" },
      { id: 11, word: "volume", ipa: "[`vÉ‘ljÉ™m]", pos: "n. [C]", meaning: "æ›¸ç±ï¼›å·ï¼›å†Š", sentence: "When I asked for a volume on time travel, the librarian looked at me as if I had lost my mind.", mnemonic: "Vol-ume -> æ›¸å·å¤šåˆ°åƒè²éŸ³çš„éŸ³é‡(Volume)ä¸€æ¨£å¤§ã€‚" },
      { id: 12, word: "acquire", ipa: "[É™`kwaÉªr]", pos: "vt.", meaning: "å­¸åˆ°ï¼›ç¿’å¾—", sentence: "Children usually acquire basic reading skills between ages six and eight.", mnemonic: "Ac-quire -> å»(Ac)è©¢å•(inquire)ä¸¦ç²å¾—è§£ç­” -> å­¸åˆ°ã€‚" },
      { id: 13, word: "profound", ipa: "[prÉ™`faÊŠnd]", pos: "adj.", meaning: "æ·±åšçš„ï¼›è¦‹è§£æ·±é çš„", sentence: "Socrates is remembered as a profound thinker who questioned everything around him.", mnemonic: "Pro-found -> å°ˆå®¶(Pro)ç™¼ç¾(found)äº†æ·±å¥§çš„é“ç†ã€‚" },
      { id: 14, word: "wealthy", ipa: "[`wÉ›lÎ¸Éª]", pos: "adj.", meaning: "å¯Œæœ‰çš„", sentence: "Since the luxurious hotel charges over US$20,000 a night, only very wealthy people can afford to stay there.", mnemonic: "Wealth-y -> æ“æœ‰è²¡å¯Œ(Wealth)çš„ã€‚" },
      { id: 15, word: "murder", ipa: "[`mÉdÉš]", pos: "vt.", meaning: "è¬€æ®º", sentence: "The victim was found brutally murdered in her apartment, with no signs of forced entry.", mnemonic: "Mur-der -> æœ«(Mur)è·¯ç‹‚å¾’çš„(der)è¡Œç‚º -> è¬€æ®ºã€‚" },
      { id: 16, word: "disgust", ipa: "[dÉªs`gÊŒst]", pos: "n. [U]", meaning: "å­æƒ¡ï¼›åæ„Ÿ", sentence: "Jennifer eats with her hands and spills food on her clothes, giving her brother a feeling of disgust.", mnemonic: "Dis-gust -> é€™(Dis)å€‹ç“¦æ–¯(gas/gust)å‘³å¥½å™å¿ƒã€‚" },
      { id: 17, word: "vain", ipa: "[ven]", pos: "adj.", meaning: "ç„¡ç”¨çš„ï¼›æ‰ç„¶çš„", sentence: "Hurley ran after the train in a vain attempt to catch it before it left the station.", mnemonic: "Vain -> åƒéœè„ˆ(Vein)ä¸€æ¨£åªæœ‰è¡€æµéä½†æ²’å¯¦è³ªä½œç”¨ -> å¾’å‹çš„ã€‚" },
      { id: 18, word: "worship", ipa: "[`wÉÊƒÉªp]", pos: "vt.", meaning: "å´‡æ‹œ", sentence: "Esther continued to worship her childhood hero even after learning about his criminal past.", mnemonic: "Wor-ship -> ç‚ºäº†(For)é‚£è‰˜èˆ¹(Ship)è†œæ‹œç¥æ˜ä¿ä½‘ -> å´‡æ‹œã€‚" },
      { id: 19, word: "intention", ipa: "[Éªn`tÉ›nÊƒÉ™n]", pos: "n. [C]", meaning: "æ‰“ç®—ï¼›æ„åœ–", sentence: "It was not Jimâ€™s intention to scare the kids with his Halloween mask; he had just wanted to surprise them.", mnemonic: "In-tent-ion -> åœ¨å¸³ç¯·(tent)è£¡çš„æ„åœ–ã€‚" },
      { id: 20, word: "abandon", ipa: "[É™`bÃ¦ndÉ™n]", pos: "vt.", meaning: "ä¸­æ­¢ï¼›æ”¾æ£„", sentence: "Anthony abandoned his efforts to fix the old car after spending too much money on repairs.", mnemonic: "A-ban-don -> ä¸€(A)å€‹ç¬¨è›‹(bandon)æ”¾æ£„äº†æ²»ç™‚ã€‚" },
      { id: 21, word: "surrender", ipa: "[sÉ™`rÉ›ndÉš]", pos: "vt.", meaning: "äº¤å‡ºï¼›æ”¾æ£„ï¼›æŠ•é™", sentence: "The general was forced to surrender the city to enemy forces after a long and costly battle.", mnemonic: "Sur-render -> æ¨(Sur)æ£„æŠµæŠ—ï¼Œä»æ…ˆ(render)æŠ•é™ã€‚" },
      { id: 22, word: "guilt", ipa: "[gÉªlt]", pos: "n. [U]", meaning: "å…§ç–š", sentence: "Many working parents feel a sense of guilt for being unable to spend more time with their children.", mnemonic: "Guilt -> å‰²(G)è‚‰èˆ¬çš„ç—›è‹¦ -> å…§ç–šã€‚" },
      { id: 23, word: "rumor", ipa: "[`rumÉš]", pos: "n. [C, U]", meaning: "è¬ è¨€ï¼›å‚³è", sentence: "Rumors were flying that a popular video game was going to be adapted into a movie.", mnemonic: "Ru-mor -> å‚³å…¥(Ru)æœ«(mor)è€³çš„æ¶ˆæ¯ -> è¬ è¨€ã€‚" },
    ];

    // --- Utilities ---
    const speak = (text, rate = 0.9) => {
      if ('speechSynthesis' in window) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = rate;
        window.speechSynthesis.speak(utterance);
      }
    };

    const getRandomItems = (arr, num) => {
      const shuffled = [...arr].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, num);
    };

    // --- Components ---

    // 1. Study Mode
    const StudyMode = ({ onComplete, progress, updateProgress }) => {
      const [currentIndex, setCurrentIndex] = useState(0);
      const [isRecording, setIsRecording] = useState(false);
      const [feedback, setFeedback] = useState(null); // 'correct', 'incorrect', 'listening'

      const currentWord = vocabData[currentIndex];
      
      const handleSpeakWord = () => speak(currentWord.word, 0.8);
      const handleSpeakSentence = () => speak(currentWord.sentence, 0.9);

      const startListening = () => {
        if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
          alert("æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜ï¼Œè«‹ä½¿ç”¨ Chrome æˆ– Edgeã€‚");
          setFeedback('correct');
          updateProgress(currentWord.id, true);
          return;
        }

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = 'en-US';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        setIsRecording(true);
        setFeedback('listening');

        recognition.start();

        recognition.onresult = (event) => {
          const transcript = event.results[0][0].transcript.toLowerCase().trim();
          const target = currentWord.word.toLowerCase();
          const cleanTranscript = transcript.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"");
          
          if (cleanTranscript === target || cleanTranscript.includes(target)) {
            setFeedback('correct');
            updateProgress(currentWord.id, true);
            speak("Great job!");
          } else {
            setFeedback('incorrect');
            speak("Try again");
          }
          setIsRecording(false);
        };

        recognition.onerror = (event) => {
          console.error(event.error);
          setIsRecording(false);
          setFeedback('error');
        };

        recognition.onend = () => {
          setIsRecording(false);
        };
      };

      const nextWord = () => {
        setFeedback(null);
        if (currentIndex < vocabData.length - 1) {
          setCurrentIndex(prev => prev + 1);
        }
      };

      const prevWord = () => {
        setFeedback(null);
        if (currentIndex > 0) {
          setCurrentIndex(prev => prev - 1);
        }
      };

      const isPassed = progress[currentWord.id] === true;

      return (
        <div className="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6">
          <div className="flex justify-between items-center mb-6 border-b pb-4">
            <h2 className="text-2xl font-bold text-blue-600 flex items-center">
              <BookOpen className="mr-2" /> å­¸ç¿’æ¨¡å¼
            </h2>
            <span className="text-gray-500 font-mono">
              {currentIndex + 1} / {vocabData.length}
            </span>
          </div>

          <div className="bg-blue-50 p-6 rounded-lg text-center mb-6 relative">
            {isPassed && <div className="absolute top-2 right-2 text-green-500"><CheckCircle /></div>}
            <h1 className="text-5xl font-extrabold text-gray-800 mb-2">{currentWord.word}</h1>
            <div className="text-xl text-gray-600 font-mono mb-2">{currentWord.ipa} {currentWord.pos}</div>
            <div className="text-2xl text-blue-800 font-bold mb-4">{currentWord.meaning}</div>
            
            <div className="bg-white p-3 rounded border border-blue-100 mb-4 text-left">
               <span className="text-xs font-bold text-blue-400 uppercase tracking-wider block mb-1">è¨˜æ†¶å°æ’‡æ­¥</span>
               <p className="text-gray-700 italic">ğŸ’¡ {currentWord.mnemonic}</p>
            </div>

            <div className="flex justify-center gap-4 mb-4">
              <button onClick={handleSpeakWord} className="flex items-center gap-2 bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-full transition">
                <Volume2 size={20} /> å”¸å–®å­—
              </button>
              <button onClick={handleSpeakSentence} className="flex items-center gap-2 bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-full transition">
                <Volume2 size={20} /> å”¸ä¾‹å¥
              </button>
            </div>
          </div>

          <div className="mb-6">
            <h3 className="text-sm font-bold text-gray-500 mb-2">ä¾‹å¥ï¼š</h3>
            <p className="text-lg text-gray-800 leading-relaxed bg-gray-50 p-4 rounded border-l-4 border-blue-400">
              {currentWord.sentence}
            </p>
          </div>

          <div className="border-t pt-6 text-center">
            <p className="mb-4 text-gray-600 font-medium">ç™¼éŸ³æª¢æ¸¬</p>
            
            <div className="flex justify-center items-center gap-4 mb-4">
              <button 
                onClick={startListening}
                disabled={isRecording}
                className={`w-20 h-20 rounded-full flex items-center justify-center shadow-lg transition transform active:scale-95 ${
                  isRecording ? 'bg-red-500 animate-pulse' : 'bg-blue-600 hover:bg-blue-700'
                }`}
              >
                <Mic size={32} className="text-white" />
              </button>
            </div>

            {feedback === 'listening' && <p className="text-blue-500 animate-bounce">æ­£åœ¨è½...</p>}
            {feedback === 'correct' && <p className="text-green-600 font-bold flex justify-center items-center gap-2"><CheckCircle /> ç™¼éŸ³æ­£ç¢ºï¼Good Job!</p>}
            {feedback === 'incorrect' && <p className="text-red-500 font-bold flex justify-center items-center gap-2"><XCircle /> å†è©¦ä¸€æ¬¡ï¼</p>}
            {feedback === 'error' && <p className="text-gray-500 text-sm">ç„¡æ³•å­˜å–éº¥å…‹é¢¨</p>}
          </div>

          <div className="flex justify-between mt-8">
            <button 
              onClick={prevWord} 
              disabled={currentIndex === 0}
              className="px-6 py-2 rounded-lg bg-gray-200 text-gray-700 disabled:opacity-50 hover:bg-gray-300 transition"
            >
              ä¸Šä¸€å€‹
            </button>
            <button 
              onClick={nextWord} 
              disabled={currentIndex === vocabData.length - 1}
              className="px-6 py-2 rounded-lg bg-blue-600 text-white disabled:opacity-50 hover:bg-blue-700 transition flex items-center gap-2"
            >
              ä¸‹ä¸€å€‹ <ArrowRight size={16} />
            </button>
          </div>
        </div>
      );
    };

    // 2. Matching Game
    const GameMatching = ({ onFinish, recordMistake }) => {
      const [cards, setCards] = useState({ left: [], right: [] });
      const [selectedLeft, setSelectedLeft] = useState(null);
      const [selectedRight, setSelectedRight] = useState(null);
      const [matchedIds, setMatchedIds] = useState([]);
      const [timer, setTimer] = useState(0);
      const [gameActive, setGameActive] = useState(false);
      const [isFinished, setIsFinished] = useState(false);

      useEffect(() => {
        let interval;
        if (gameActive && !isFinished) {
          interval = setInterval(() => setTimer(t => t + 1), 1000);
        }
        return () => clearInterval(interval);
      }, [gameActive, isFinished]);

      const startGame = () => {
        const shuffledLeft = [...vocabData].sort(() => 0.5 - Math.random());
        const shuffledRight = [...vocabData].sort(() => 0.5 - Math.random());
        
        setCards({ left: shuffledLeft, right: shuffledRight });
        setMatchedIds([]);
        setTimer(0);
        setGameActive(true);
        setIsFinished(false);
      };

      const handleSelectLeft = (id) => {
        if (matchedIds.includes(id)) return;
        setSelectedLeft(id);
        checkMatch(id, selectedRight);
      };

      const handleSelectRight = (id) => {
        if (matchedIds.includes(id)) return;
        setSelectedRight(id);
        checkMatch(selectedLeft, id);
      };

      const checkMatch = (leftId, rightId) => {
        if (leftId && rightId) {
          if (leftId === rightId) {
            const newMatched = [...matchedIds, leftId];
            setMatchedIds(newMatched);
            speak("Correct");
            if (newMatched.length === vocabData.length) {
              endGame(true);
            }
          } else {
            speak("Wrong");
            recordMistake(leftId);
            setTimeout(() => {
              setSelectedLeft(null);
              setSelectedRight(null);
            }, 500);
            return;
          }
          setSelectedLeft(null);
          setSelectedRight(null);
        }
      };

      const endGame = (completed) => {
        setIsFinished(true);
        setGameActive(false);
        onFinish({
          score: completed ? vocabData.length : matchedIds.length,
          passed: completed && timer <= 60,
          time: timer
        });
      };

      if (!gameActive && !isFinished) {
        return (
          <div className="text-center p-10 bg-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4">ç¬¬ä¸€é—œï¼šå–®å­—é€£é€£çœ‹</h2>
            <p className="mb-6 text-gray-600">è«‹å°‡è‹±æ–‡å–®å­—èˆ‡ä¸­æ–‡è§£é‡‹é…å°ã€‚</p>
            <div className="flex items-center justify-center gap-2 mb-6 text-orange-600 font-bold">
              <Clock /> ç›®æ¨™ï¼š60ç§’å…§å®Œæˆ
            </div>
            <button onClick={startGame} className="bg-blue-600 text-white px-8 py-3 rounded-full text-lg hover:bg-blue-700 shadow-lg">é–‹å§‹æŒ‘æˆ°</button>
          </div>
        );
      }

      if (isFinished) {
        return (
          <div className="text-center p-10 bg-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4">éŠæˆ²çµæŸ</h2>
            <p className="text-4xl font-mono mb-4">{timer} ç§’</p>
            {timer <= 60 && matchedIds.length === vocabData.length ? (
              <div className="text-green-600 font-bold text-xl mb-6">ğŸ‰ æŒ‘æˆ°æˆåŠŸï¼ (Passed)</div>
            ) : (
              <div className="text-red-500 font-bold text-xl mb-6">âŒ æŒ‘æˆ°å¤±æ•— (éœ€60ç§’å…§å®Œæˆ)</div>
            )}
            <button onClick={startGame} className="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg mr-4">é‡ç©</button>
            <button onClick={() => onFinish({ score: matchedIds.length, passed: timer <= 60, time: timer }, true)} className="bg-blue-600 text-white px-6 py-2 rounded-lg">ä¸‹ä¸€æ­¥</button>
          </div>
        );
      }

      return (
        <div className="bg-white rounded-xl shadow-lg p-4 h-[80vh] flex flex-col">
          <div className="flex justify-between items-center mb-4 px-4">
            <div className={`font-mono text-xl font-bold ${timer > 60 ? 'text-red-500' : 'text-blue-600'}`}>
              â± {timer}s
            </div>
            <div className="text-gray-500">
              é€²åº¦: {matchedIds.length} / {vocabData.length}
            </div>
          </div>
          
          <div className="flex-1 overflow-y-auto grid grid-cols-2 gap-4 p-2">
            <div className="space-y-2">
              {cards.left.map(word => (
                <button
                  key={`l-${word.id}`}
                  onClick={() => handleSelectLeft(word.id)}
                  disabled={matchedIds.includes(word.id)}
                  className={`w-full p-3 rounded-lg border text-left font-bold transition-all text-sm md:text-base
                    ${matchedIds.includes(word.id) ? 'bg-gray-100 text-gray-400 border-transparent opacity-50' : 
                      selectedLeft === word.id ? 'bg-blue-500 text-white border-blue-600 shadow-md scale-105' : 'bg-white border-gray-200 hover:border-blue-300 hover:bg-blue-50'}`}
                >
                  {word.word}
                </button>
              ))}
            </div>
            <div className="space-y-2">
              {cards.right.map(word => (
                <button
                  key={`r-${word.id}`}
                  onClick={() => handleSelectRight(word.id)}
                  disabled={matchedIds.includes(word.id)}
                  className={`w-full p-3 rounded-lg border text-left text-sm md:text-base transition-all
                    ${matchedIds.includes(word.id) ? 'bg-gray-100 text-gray-400 border-transparent opacity-50' : 
                      selectedRight === word.id ? 'bg-blue-500 text-white border-blue-600 shadow-md scale-105' : 'bg-white border-gray-200 hover:border-blue-300 hover:bg-blue-50'}`}
                >
                  {word.meaning}
                </button>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // 3. Listening Game
    const GameListening = ({ onFinish, recordMistake }) => {
      const [questions, setQuestions] = useState([]);
      const [currentQIndex, setCurrentQIndex] = useState(0);
      const [score, setScore] = useState(0);
      const [gameStatus, setGameStatus] = useState('intro'); 
      const [lastAnswerCorrect, setLastAnswerCorrect] = useState(null);

      const initGame = () => {
        const qList = getRandomItems(vocabData, 15).map(word => {
          const distractors = getRandomItems(vocabData.filter(w => w.id !== word.id), 3);
          const options = [word, ...distractors].sort(() => 0.5 - Math.random());
          return { target: word, options };
        });
        setQuestions(qList);
        setCurrentQIndex(0);
        setScore(0);
        setGameStatus('playing');
        setLastAnswerCorrect(null);
        setTimeout(() => speak(qList[0].target.word), 500);
      };

      const handleAnswer = (selectedWord) => {
        const currentQ = questions[currentQIndex];
        const isCorrect = selectedWord.id === currentQ.target.id;

        if (isCorrect) {
          setScore(s => s + 1);
          setLastAnswerCorrect(true);
          speak("Correct");
        } else {
          setLastAnswerCorrect(false);
          speak("Wrong");
          recordMistake(currentQ.target.id);
        }

        setTimeout(() => {
          if (currentQIndex < 14) {
            setCurrentQIndex(p => p + 1);
            setLastAnswerCorrect(null);
            speak(questions[currentQIndex + 1].target.word);
          } else {
            setGameStatus('finished');
          }
        }, 1000);
      };

      const playCurrentSound = () => {
        speak(questions[currentQIndex].target.word);
      };

      if (gameStatus === 'intro') {
        return (
          <div className="text-center p-10 bg-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4">ç¬¬äºŒé—œï¼šè½éŸ³è¾¨ç¾©</h2>
            <p className="mb-6 text-gray-600">è½è‹±æ–‡å–®å­—ï¼Œé¸å‡ºæ­£ç¢ºçš„ä¸­æ–‡è§£é‡‹ã€‚</p>
            <div className="flex items-center justify-center gap-2 mb-6 text-orange-600 font-bold">
              <List /> å…±15é¡Œï¼Œéœ€ç­”å°10é¡Œéé—œ
            </div>
            <button onClick={initGame} className="bg-blue-600 text-white px-8 py-3 rounded-full text-lg hover:bg-blue-700 shadow-lg">é–‹å§‹æŒ‘æˆ°</button>
          </div>
        );
      }

      if (gameStatus === 'finished') {
         const passed = score >= 10;
         return (
          <div className="text-center p-10 bg-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4">éŠæˆ²çµæŸ</h2>
            <p className="text-lg mb-2">å¾—åˆ†ï¼š{score} / 15</p>
            {passed ? (
              <div className="text-green-600 font-bold text-xl mb-6">ğŸ‰ é€šéæ¸¬é©—ï¼</div>
            ) : (
              <div className="text-red-500 font-bold text-xl mb-6">âŒ æœªé€šé (éœ€10åˆ†)</div>
            )}
            <button onClick={initGame} className="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg mr-4">é‡ç©</button>
            <button onClick={() => onFinish({ score, passed }, true)} className="bg-blue-600 text-white px-6 py-2 rounded-lg">ä¸‹ä¸€æ­¥</button>
          </div>
        );
      }

      const currentQ = questions[currentQIndex];

      return (
        <div className="max-w-xl mx-auto bg-white rounded-xl shadow-lg p-6">
          <div className="flex justify-between mb-6">
            <span className="font-bold text-gray-500">Q{currentQIndex + 1}/15</span>
            <span className="font-bold text-blue-600">Score: {score}</span>
          </div>

          <div className="text-center mb-8">
            <button 
              onClick={playCurrentSound}
              className="w-24 h-24 bg-blue-100 hover:bg-blue-200 rounded-full inline-flex items-center justify-center transition"
            >
              <Volume2 size={40} className="text-blue-600" />
            </button>
            <p className="mt-2 text-sm text-gray-500">é»æ“Šæ’­æ”¾è²éŸ³</p>
          </div>

          <div className="grid grid-cols-1 gap-3">
            {currentQ.options.map((opt, idx) => (
              <button
                key={idx}
                onClick={() => handleAnswer(opt)}
                disabled={lastAnswerCorrect !== null}
                className={`p-4 rounded-lg border text-left font-medium transition
                  ${lastAnswerCorrect !== null && opt.id === currentQ.target.id ? 'bg-green-100 border-green-500' : ''}
                  ${lastAnswerCorrect === false && opt.id !== currentQ.target.id ? 'opacity-50' : ''}
                  ${lastAnswerCorrect === null ? 'hover:bg-blue-50 hover:border-blue-300' : ''}
                `}
              >
                {opt.meaning}
              </button>
            ))}
          </div>
           {lastAnswerCorrect !== null && (
              <div className="mt-4 text-center font-bold text-xl animate-bounce">
                {lastAnswerCorrect ? <span className="text-green-500">Correct! {currentQ.target.word}</span> : <span className="text-red-500">Oops! It was {currentQ.target.word}</span>}
              </div>
            )}
        </div>
      );
    };

    // 4. Cloze Game
    const GameCloze = ({ onFinish, recordMistake }) => {
      const [questions, setQuestions] = useState([]);
      const [currentQIndex, setCurrentQIndex] = useState(0);
      const [score, setScore] = useState(0);
      const [gameStatus, setGameStatus] = useState('intro');
      const [lastAnswerCorrect, setLastAnswerCorrect] = useState(null);

      const initGame = () => {
        const qList = getRandomItems(vocabData, 15).map(word => {
          const regex = new RegExp(word.word, 'gi');
          const clozeSentence = word.sentence.replace(regex, '_______');
          
          const distractors = getRandomItems(vocabData.filter(w => w.id !== word.id), 3);
          const options = [word, ...distractors].sort(() => 0.5 - Math.random());
          
          return { target: word, sentence: clozeSentence, options };
        });
        setQuestions(qList);
        setCurrentQIndex(0);
        setScore(0);
        setGameStatus('playing');
        setLastAnswerCorrect(null);
      };

      const handleAnswer = (selectedWord) => {
        const currentQ = questions[currentQIndex];
        const isCorrect = selectedWord.id === currentQ.target.id;

        if (isCorrect) {
          setScore(s => s + 1);
          setLastAnswerCorrect(true);
          speak("Correct");
        } else {
          setLastAnswerCorrect(false);
          speak("Wrong");
          recordMistake(currentQ.target.id);
        }

        setTimeout(() => {
          if (currentQIndex < 14) {
            setCurrentQIndex(p => p + 1);
            setLastAnswerCorrect(null);
          } else {
            setGameStatus('finished');
          }
        }, 1500);
      };

      if (gameStatus === 'intro') {
        return (
          <div className="text-center p-10 bg-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4">ç¬¬ä¸‰é—œï¼šæ–‡æ„å¡«ç©º</h2>
            <p className="mb-6 text-gray-600">é–±è®€ä¾‹å¥ï¼Œé¸å‡ºæœ€é©åˆå¡«å…¥ç©ºæ ¼çš„å–®å­—ã€‚</p>
            <div className="flex items-center justify-center gap-2 mb-6 text-orange-600 font-bold">
              <Brain /> å…±15é¡Œï¼Œéœ€ç­”å°10é¡Œéé—œ
            </div>
            <button onClick={initGame} className="bg-blue-600 text-white px-8 py-3 rounded-full text-lg hover:bg-blue-700 shadow-lg">é–‹å§‹æŒ‘æˆ°</button>
          </div>
        );
      }

      if (gameStatus === 'finished') {
        const passed = score >= 10;
         return (
          <div className="text-center p-10 bg-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4">éŠæˆ²çµæŸ</h2>
            <p className="text-lg mb-2">å¾—åˆ†ï¼š{score} / 15</p>
            {passed ? (
              <div className="text-green-600 font-bold text-xl mb-6">ğŸ‰ é€šéæ¸¬é©—ï¼</div>
            ) : (
              <div className="text-red-500 font-bold text-xl mb-6">âŒ æœªé€šé (éœ€10åˆ†)</div>
            )}
            <button onClick={initGame} className="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg mr-4">é‡ç©</button>
            <button onClick={() => onFinish({ score, passed }, true)} className="bg-blue-600 text-white px-6 py-2 rounded-lg">æŸ¥çœ‹æˆç¸¾å–®</button>
          </div>
        );
      }

      const currentQ = questions[currentQIndex];

      return (
        <div className="max-w-xl mx-auto bg-white rounded-xl shadow-lg p-6">
          <div className="flex justify-between mb-6">
            <span className="font-bold text-gray-500">Q{currentQIndex + 1}/15</span>
            <span className="font-bold text-blue-600">Score: {score}</span>
          </div>

          <div className="mb-8 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
            <p className="text-lg leading-relaxed text-gray-800">
              {lastAnswerCorrect === true 
                ? currentQ.sentence.replace('_______', currentQ.target.word)
                : currentQ.sentence}
            </p>
            <div className="mt-2 text-sm text-gray-500">{currentQ.target.meaning}</div>
          </div>

          <div className="grid grid-cols-2 gap-3">
            {currentQ.options.map((opt, idx) => (
              <button
                key={idx}
                onClick={() => handleAnswer(opt)}
                disabled={lastAnswerCorrect !== null}
                className={`p-3 rounded-lg border text-center font-bold transition
                  ${lastAnswerCorrect !== null && opt.id === currentQ.target.id ? 'bg-green-100 border-green-500 text-green-700' : ''}
                  ${lastAnswerCorrect === false && opt.id !== currentQ.target.id ? 'opacity-50' : ''}
                  ${lastAnswerCorrect === null ? 'bg-white hover:bg-blue-50 hover:border-blue-300' : ''}
                `}
              >
                {opt.word}
              </button>
            ))}
          </div>
          {lastAnswerCorrect === false && (
             <div className="mt-4 text-center text-red-500 font-bold">
                Correct answer: {currentQ.target.word}
             </div>
          )}
        </div>
      );
    };

    // Report Card
    const ReportCard = ({ pronunciationProgress, gameStats, mistakes }) => {
      const serialNumber = useRef(Math.floor(100000 + Math.random() * 900000));
      
      const pronouncedCount = Object.values(pronunciationProgress).filter(v => v).length;
      const pronPercent = Math.round((pronouncedCount / vocabData.length) * 100);

      const mistakeCounts = {};
      mistakes.forEach(id => {
        mistakeCounts[id] = (mistakeCounts[id] || 0) + 1;
      });
      
      const topMistakes = Object.entries(mistakeCounts)
        .sort(([, a], [, b]) => b - a)
        .slice(0, 5)
        .map(([id]) => vocabData.find(w => w.id === parseInt(id)));

      return (
        <div className="max-w-2xl mx-auto bg-white border-4 border-double border-blue-200 p-8 rounded-lg shadow-2xl relative overflow-hidden">
            <div className="absolute top-10 right-10 opacity-5 rotate-12 text-gray-800">
                <Trophy size={200} />
            </div>

          <div className="text-center border-b-2 border-gray-200 pb-4 mb-6">
            <h1 className="text-3xl font-extrabold text-blue-800 tracking-wide uppercase">æˆç¸¾å–® (Report Card)</h1>
            <p className="text-gray-500 mt-2 font-mono">Serial No: #{serialNumber.current}</p>
            <p className="text-sm text-gray-400">{new Date().toLocaleDateString()} {new Date().toLocaleTimeString()}</p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div className="bg-blue-50 p-4 rounded-lg">
              <h3 className="font-bold text-gray-700 mb-2 flex items-center gap-2"><Mic size={18}/> ç™¼éŸ³æª¢æ¸¬é€²åº¦</h3>
              <div className="text-4xl font-bold text-blue-600">{pronPercent}%</div>
              <p className="text-sm text-gray-500">å·²å®Œæˆ {pronouncedCount} / {vocabData.length} å€‹å–®å­—</p>
            </div>
            
            <div className="bg-yellow-50 p-4 rounded-lg">
              <h3 className="font-bold text-gray-700 mb-2 flex items-center gap-2"><Gamepad2 size={18}/> éŠæˆ²é€šé—œç´€éŒ„</h3>
              <ul className="space-y-2 text-sm">
                 <li className="flex justify-between">
                    <span>é€£é€£çœ‹:</span> 
                    <span className={gameStats.game1.passed ? 'text-green-600 font-bold' : 'text-red-500 font-bold'}>
                        {gameStats.game1.passed ? `é€šé (${gameStats.game1.time}s)` : 'æœªé€šé'}
                    </span>
                 </li>
                 <li className="flex justify-between">
                    <span>è½éŸ³è¾¨ç¾©:</span> 
                    <span className={gameStats.game2.passed ? 'text-green-600 font-bold' : 'text-red-500 font-bold'}>
                        {gameStats.game2.passed ? `é€šé (${gameStats.game2.score}/15)` : `æœªé€šé (${gameStats.game2.score}/15)`}
                    </span>
                 </li>
                 <li className="flex justify-between">
                    <span>æ–‡æ„å¡«ç©º:</span> 
                    <span className={gameStats.game3.passed ? 'text-green-600 font-bold' : 'text-red-500 font-bold'}>
                        {gameStats.game3.passed ? `é€šé (${gameStats.game3.score}/15)` : `æœªé€šé (${gameStats.game3.score}/15)`}
                    </span>
                 </li>
              </ul>
            </div>
          </div>

          <div className="mb-8">
             <h3 className="font-bold text-red-600 mb-3 border-b border-red-100 pb-1">âš ï¸ éœ€åŠ å¼·å–®å­— (Top 5 Weakest Words)</h3>
             {topMistakes.length > 0 ? (
                 <div className="grid grid-cols-1 gap-2">
                     {topMistakes.map(word => (
                         <div key={word.id} className="flex justify-between items-center bg-red-50 p-2 rounded px-4">
                             <span className="font-bold text-gray-800">{word.word}</span>
                             <span className="text-gray-600 text-sm">{word.meaning}</span>
                         </div>
                     ))}
                 </div>
             ) : (
                 <p className="text-green-600 italic">å¤ªæ£’äº†ï¼ç›®å‰æ²’æœ‰æ˜é¡¯çš„å¼±é»å–®å­—ã€‚</p>
             )}
          </div>

          <div className="bg-gray-800 text-white p-4 rounded-lg text-center mt-6">
            <p className="flex items-center justify-center gap-2 font-bold animate-pulse">
                <AlertCircle /> è«‹æˆªåœ–æ­¤ç•«é¢å‚³çµ¦è€å¸«ç¹³äº¤ä½œæ¥­
            </p>
          </div>
        </div>
      );
    };

    // --- Main App Component ---
    function App() {
      const [view, setView] = useState('home');
      const [practiceStep, setPracticeStep] = useState(0);
      
      const [pronunciationProgress, setPronunciationProgress] = useState({});
      const [gameStats, setGameStats] = useState({
        game1: { passed: false, score: 0, time: 0 },
        game2: { passed: false, score: 0 },
        game3: { passed: false, score: 0 },
      });
      const [mistakes, setMistakes] = useState([]);

      const updatePronunciation = (id, status) => {
        setPronunciationProgress(prev => ({...prev, [id]: status}));
      };

      const recordMistake = (id) => {
        setMistakes(prev => [...prev, id]);
      };

      const handleGameFinish = (gameId, stats, next) => {
        setGameStats(prev => ({
            ...prev,
            [gameId]: stats
        }));
        if (next) {
            if (gameId === 'game1') setPracticeStep(2);
            if (gameId === 'game2') setPracticeStep(3);
            if (gameId === 'game3') setView('report');
        }
      };

      return (
        <div className="max-w-4xl mx-auto p-4">
          <nav className="bg-white/80 backdrop-blur rounded-full px-6 py-3 mb-6 shadow-sm flex flex-col md:flex-row justify-between items-center sticky top-2 z-10 gap-2">
            <div className="font-bold text-blue-800 text-lg flex items-center gap-2 cursor-pointer" onClick={() => {setView('home'); setPracticeStep(0);}}>
                <BookOpen size={24} /> L1 å–®å­—ç‰¹è¨“ç­
            </div>
            <div className="flex gap-2">
                <button 
                    onClick={() => setView('study')} 
                    className={`px-3 py-1 rounded-full text-sm font-medium transition ${view === 'study' ? 'bg-blue-600 text-white' : 'hover:bg-blue-100 text-gray-600'}`}
                >
                    å­¸ç¿’æ¨¡å¼
                </button>
                <button 
                    onClick={() => {setView('practice'); setPracticeStep(0);}} 
                    className={`px-3 py-1 rounded-full text-sm font-medium transition ${view === 'practice' ? 'bg-orange-500 text-white' : 'hover:bg-orange-100 text-gray-600'}`}
                >
                    ç·´ç¿’æ¨¡å¼
                </button>
                 <button 
                    onClick={() => setView('report')} 
                    className={`px-3 py-1 rounded-full text-sm font-medium transition ${view === 'report' ? 'bg-purple-600 text-white' : 'hover:bg-purple-100 text-gray-600'}`}
                >
                    æˆç¸¾å–®
                </button>
            </div>
          </nav>

          <main className="pb-10">
            {view === 'home' && (
              <div className="text-center py-10 md:py-20 animate-in fade-in zoom-in duration-500">
                <h1 className="text-4xl md:text-5xl font-extrabold text-blue-900 mb-6 drop-shadow-sm">è‹±æ–‡å–®å­—å¤§ä½œæˆ°</h1>
                <p className="text-xl text-blue-700 mb-10">Lesson 1: 23 å€‹ç²¾é¸å–®å­—ç­‰ä½ ä¾†æŒ‘æˆ°ï¼</p>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto">
                    <div onClick={() => setView('study')} className="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:scale-105 transition cursor-pointer border-t-8 border-blue-500 group">
                        <div className="flex justify-center text-blue-500 mb-4 group-hover:rotate-12 transition-transform"><BookOpen size={48} /></div>
                        <h2 className="text-2xl font-bold mb-2">A. å­¸ç¿’æ¨¡å¼</h2>
                        <p className="text-gray-500">è«§éŸ³åŠ©è¨˜ã€ç™¼éŸ³æª¢æ¸¬ã€ä¾‹å¥æœ—è®€</p>
                    </div>
                    <div onClick={() => {setView('practice'); setPracticeStep(1);}} className="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:scale-105 transition cursor-pointer border-t-8 border-orange-500 group">
                         <div className="flex justify-center text-orange-500 mb-4 group-hover:rotate-12 transition-transform"><Gamepad2 size={48} /></div>
                        <h2 className="text-2xl font-bold mb-2">B. ç·´ç¿’æ¨¡å¼</h2>
                        <p className="text-gray-500">ä¸‰é“é—œå¡ï¼šé…å°ã€è½åŠ›ã€å¡«ç©º</p>
                    </div>
                </div>
              </div>
            )}

            {view === 'study' && (
                <StudyMode 
                    progress={pronunciationProgress} 
                    updateProgress={updatePronunciation} 
                />
            )}

            {view === 'practice' && (
                <div>
                    {practiceStep === 0 && (
                        <div className="text-center p-10">
                            <h2 className="text-2xl font-bold mb-6">é¸æ“‡é—œå¡</h2>
                            <div className="flex flex-col gap-4 max-w-xs mx-auto">
                                <button onClick={() => setPracticeStep(1)} className="bg-white p-4 rounded shadow hover:bg-blue-50 text-left font-bold border-l-4 border-blue-500">Level 1: å–®å­—é…å°</button>
                                <button onClick={() => setPracticeStep(2)} className="bg-white p-4 rounded shadow hover:bg-blue-50 text-left font-bold border-l-4 border-blue-500">Level 2: è½éŸ³é¸ä¸­</button>
                                <button onClick={() => setPracticeStep(3)} className="bg-white p-4 rounded shadow hover:bg-blue-50 text-left font-bold border-l-4 border-blue-500">Level 3: æ–‡æ„å¡«ç©º</button>
                            </div>
                        </div>
                    )}
                    {practiceStep === 1 && <GameMatching onFinish={(stats, next) => handleGameFinish('game1', stats, next)} recordMistake={recordMistake} />}
                    {practiceStep === 2 && <GameListening onFinish={(stats, next) => handleGameFinish('game2', stats, next)} recordMistake={recordMistake} />}
                    {practiceStep === 3 && <GameCloze onFinish={(stats, next) => handleGameFinish('game3', stats, next)} recordMistake={recordMistake} />}
                </div>
            )}

            {view === 'report' && (
                <ReportCard 
                    pronunciationProgress={pronunciationProgress}
                    gameStats={gameStats}
                    mistakes={mistakes}
                />
            )}
          </main>
        </div>
      );
    }

    // Render
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>

</body>
</html>